# Collaboration & Debug Tips (Codex <-> Matt)
Purpose: Running log of what worked, what broke, and why.

[2025-08-13 17:00] Topic: Logging DI refactor
Context: Introduced constructor injection for logging services and confirmation helpers.
Observations: Simplifies testing and removes static logger state.
Codex Limitations noticed: Unable to execute Windows-specific tests in container.
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Use DI to share single logging service and helpers.
Action Items: Monitor CI for Windows-specific behaviors.
Related Commits/PRs: (this PR)

[2025-08-15 00:00] Topic: MQTT service refactor
Context: Simplified MQTT client by unifying constructors and publish APIs.
Observations: Connect now disconnects before reconnecting and raises connection state events.
Codex Limitations noticed: dotnet SDK unavailable locally.
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Reduce surface area and ensure consistent token resolution across publishes.
Action Items: Install .NET SDK to run tests locally.
Related Commits/PRs: (this PR)

[2025-08-14 14:08] Topic: MQTT service options
Context: Added option-based MQTT service with reconnection and TLS/WebSocket support.
Observations: MQTTnet API changes required using new builder patterns.
Codex Limitations noticed: Missing WindowsDesktop runtime prevented executing tests.
Effective Prompts / Instructions that worked: Following AGENTS.md to attempt local tests and update docs.
Decisions & Rationale: Centralized connection settings via options and enabled auto-reconnect for resilience.
Action Items: Ensure environment has WindowsDesktop runtime for full test coverage.
Related Commits/PRs: (this PR)

[2025-08-13 20:41] Topic: WPF workload in CI
Context: GitHub Actions failed because the `windowsdesktop` workload is no longer recognized.
Observations: Replacing it with the `wpf` workload restores pipeline compatibility.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: verifying commands against GitHub runners.
Decisions & Rationale: Use the `wpf` workload across build, test, quality, and packaging jobs.
Action Items: Monitor CI for workload availability changes.
Related Commits/PRs: (this PR)

[2025-08-13 17:40] Topic: Navigation bar logo
Context: Replaced placeholder text with application logo in main window.
Observations: Logo displays brand and cleans up header.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Use embedded image resource for branding.
Action Items: none
Related Commits/PRs: (this PR)

[2025-08-13 17:52] Topic: Logo resource path fix
Context: Navigation bar logo failed to render because image path was relative to the view folder.
Observations: Using a root-relative path loads the embedded image correctly.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: Providing exact asset location.
Decisions & Rationale: Use root-relative resource paths for WPF assets.
Action Items: Ensure future asset references include leading slash.
Related Commits/PRs: (this PR)

[2025-08-13 18:09] Topic: CI runs on feature branches
Context: Enabled GitHub Actions to execute tests on pushes to `feature/**` and `bugfix/**` branches.
Observations: Codex can push code to trigger remote tests without local execution.
Codex Limitations noticed: `dotnet test` cannot run `net8.0-windows` tests on Linux.
Effective Prompts / Instructions that worked: Configuring push patterns and `workflow_dispatch`.
Decisions & Rationale: Use GitHub-hosted runners to centralize validation.
Action Items: Monitor CI runs for unexpected failures.
Related Commits/PRs: (this PR)
 [2025-08-14 14:08] Topic: MQTT service TLS and routing tests
Context: Added TLS/connect tests for MQTT service and expanded view model to resolve tokens and publish to multiple topics.
Observations: Installing matching .NET SDK enabled building Windows-targeted tests, but runtime is unavailable on Linux.
Codex Limitations noticed: Cannot execute Microsoft.WindowsDesktop runtime locally.
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Implement TLS and disconnect logic to satisfy unit test coverage.
Action Items: Run full test suite on a Windows environment.
Related Commits/PRs: (this PR)

[2025-08-13 18:28] Topic: CI workflow consolidation
Context: Unified multiple GitHub workflows into a single pipeline and added AGENTS instructions to review changelog and collaboration tips.
Observations: Centralized CI reduces maintenance overhead.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Single pipeline with build, test, quality, and packaging jobs.
Action Items: Monitor self-heal integration with new pipeline.
Related Commits/PRs: (this PR)

[2025-08-13 18:50] Topic: On-demand CI via /test comment
Context: Enabled `/test` comment workflow and documented CI-only testing policy.
Observations: CI can run without local test execution.
Codex Limitations noticed: Tests cannot run on Linux container; rely on GitHub Actions.
Effective Prompts / Instructions that worked: Using comment trigger pattern from user guidance.
Decisions & Rationale: Centralize validation in CI and enforce via docs and PR template.
Action Items: Ensure branch protection requires CI.
Related Commits/PRs: (this PR)

[2025-08-13 19:01] Topic: Async command refactor
Context: Introduced AsyncRelayCommand and async script evaluation to prevent UI blocking.
Observations: Async command simplifies long-running actions and avoids deadlocks.
Codex Limitations noticed: PowerShell unavailable; tip appended manually.
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Use AsyncRelayCommand for operations needing await without blocking.
Action Items: Monitor for unhandled exceptions in async commands.
Related Commits/PRs: (this PR)

[2025-08-13 19:42] Topic: Remove unused classes
Context: Cleaned up obsolete logging and template control types.
Observations: Deleting `RichTextLogger` and installer `CustomControl1` simplified the codebase with no build impact.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Prefer removing stale classes to reduce maintenance and confusion.
Action Items: Monitor builds for any lingering references.
Related Commits/PRs: (this PR)

[2025-08-14 14:03] Topic: MQTT endpoint tooltips
Context: Added tooltips for MQTT fields and enforced disconnect-before-reconnect behavior.
Observations: Static and token messages publish across multiple endpoints.
Codex Limitations noticed: WindowsDesktop runtime unavailable; tests aborted.
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Disconnect before reconnect ensures settings apply cleanly.
Action Items: Review MQTT reconnect logic.

[2025-08-14 14:00] Topic: MQTT token routing
Context: Documented configuration requirements for new MQTT routing features.
Observations: Need to disconnect before changing MQTT settings; `{ServiceName.Message}` tokens enable routing across multiple endpoints.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: n/a
Decisions & Rationale: Highlight prerequisites and token usage to prevent misconfiguration.
Action Items: Disconnect prior to updating MQTT settings; map tokens to desired endpoints.

[2025-08-14 14:02] Topic: MQTT endpoint-message UI
Context: (summarize the scenario)
Observations: Implemented endpoint-message pair configuration with placeholders and tooltips.
Codex Limitations noticed: pwsh not available to run add-tip script.
Effective Prompts / Instructions that worked: Instructions emphasized placeholders and tooltips.
Decisions & Rationale: Added DataGrid with Add/Remove commands to manage pairs.
Action Items: Extend MqttServiceViewModel and tests.
Related Commits/PRs:

[2025-08-14 14:04] Topic: MQTT options and token publishing
Context: Exposed MqttServiceOptions with validation and disconnect-on-change logic; added tokenized endpoint/message publishing.
Observations: Shared options instance simplifies configuration updates and publishing multiple messages.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: leveraging existing MVVM validation patterns
Decisions & Rationale: Disconnect before applying new settings to avoid stale connections.
Action Items: Monitor MQTT connection stability in UI.


[2025-08-14 00:00] Topic: MQTT message routing
Context: Introduced registry to resolve service message tokens before publishing.
Observations: Enables multiple services to publish through one endpoint.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: leveraging token patterns like {Service.Message}.
Decisions & Rationale: Central registry simplifies token resolution and keeps MQTT service focused on transport.
Action Items: Expand registry usage across services as needed.

[2025-08-14 14:01] Topic: MQTT service options
Context: Introduced strongly typed options with defaults and bounds for MQTT configuration.
Observations: Centralizes broker settings and guards against invalid ranges.
Codex Limitations noticed: Original spec table unavailable; defaults inferred from common MQTT usage.
Effective Prompts / Instructions that worked: Detailed property list with default and range guidance.
Decisions & Rationale: Provide options model for future DI and configuration binding.
Action Items: Wire options into service and configuration pipeline later.

Related Commits/PRs: (this PR)
[2025-08-15 12:00] Topic: Message routing service cleanup
Context: Simplified message tracking and removed redundant WPF workload installs.
Observations: ConcurrentDictionary with optional logging keeps token resolution thread-safe.
Codex Limitations noticed: Unable to run net8.0-windows tests on Linux container.
Effective Prompts / Instructions that worked: Following AGENTS.md to update docs and remove unused workflow steps.
Decisions & Rationale: Extract interface and rely on built-in .NET 8 SDK components for cleaner CI.
Action Items: Validate on Windows runners.
Related Commits/PRs: (this PR)

[2025-08-16 00:00] Topic: MQTT view model cleanup
Context: Standardized MqttServiceViewModel to use options-backed settings and shared message routing.
Observations: Removed legacy publish fields and delegated token resolution to MessageRoutingService.
Codex Limitations noticed: net8.0-windows tests cannot execute in Linux container.
Effective Prompts / Instructions that worked: Leveraging DI registrations and validation helpers.
Decisions & Rationale: Share routing service across layers for consistent token handling.
Action Items: Execute full test suite on Windows runners.
Related Commits/PRs: (this PR)
[2025-08-15 10:00] Topic: MQTT DI options
Context: (summarize the scenario)
Observations: Removed standalone options registration, adopted IOptions in constructors, and added DI container test.
Codex Limitations noticed:
Effective Prompts / Instructions that worked:
Decisions & Rationale: Standardized on IOptions for configuration and verified ServiceProvider builds.
Action Items: Run tests
Related Commits/PRs:
[2025-08-16 12:00] Topic: MQTT options duplication fix
Context: Build failed due to duplicate ClientId property from obsolete options model.
Observations: Removing the legacy model and updating references restored a successful build.
Codex Limitations noticed: none
Effective Prompts / Instructions that worked: ripgrep to locate conflicting types.
Decisions & Rationale: Consolidated MQTT options under Services namespace to avoid ambiguity.
Action Items: Ensure tests reference the unified options type.
Related Commits/PRs: (this PR)
